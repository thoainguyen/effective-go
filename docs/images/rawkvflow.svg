<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="509px" preserveAspectRatio="none" style="width:420px;height:509px;" version="1.1" viewBox="0 0 420 509" width="420px" zoomAndPan="magnify"><defs><filter height="300%" id="fdkyj7cbq33ql" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fdkyj7cbq33ql)" height="396.5313" style="stroke: #000000; stroke-width: 2.0;" width="395.5" x="13" y="55.2969"/><rect fill="#FFFFFF" height="233.7344" style="stroke: none; stroke-width: 1.0;" width="395.5" x="13" y="218.0938"/><rect fill="#FFFFFF" filter="url(#fdkyj7cbq33ql)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="175" x="23" y="239.8984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="60" x2="60" y1="38.2969" y2="468.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="178" x2="178" y1="38.2969" y2="468.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="316.5" x2="316.5" y1="38.2969" y2="468.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="371.5" x2="371.5" y1="38.2969" y2="468.8281"/><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="33" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="40" y="22.9951">client</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="33" y="467.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="40" y="487.8232">client</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="141" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="148" y="22.9951">mtikv_cli</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="141" y="467.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="148" y="487.8232">mtikv_cli</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="32" x="298.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="305.5" y="22.9951">pd</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="32" x="298.5" y="467.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="305.5" y="487.8232">pd</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="344.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="351.5" y="22.9951">mtikv</text><rect fill="#FEFECE" filter="url(#fdkyj7cbq33ql)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="344.5" y="467.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="351.5" y="487.8232">mtikv</text><path d="M13,55.2969 L77,55.2969 L77,62.2969 L67,72.2969 L13,72.2969 L13,55.2969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="396.5313" style="stroke: #000000; stroke-width: 2.0;" width="395.5" x="13" y="55.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="68.3638">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="92" y="67.5073">[do get]</text><polygon fill="#A80036" points="166.5,89.5625,176.5,93.5625,166.5,97.5625,170.5,93.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="172.5" y1="93.5625" y2="93.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="67.5" y="88.4966">get(key)</text><polygon fill="#A80036" points="304.5,118.6953,314.5,122.6953,304.5,126.6953,308.5,122.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178.5" x2="310.5" y1="122.6953" y2="122.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="185.5" y="117.6294">last_ts = getTso()</text><polygon fill="#A80036" points="359.5,147.8281,369.5,151.8281,359.5,155.8281,363.5,151.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178.5" x2="365.5" y1="151.8281" y2="151.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="185.5" y="146.7622">get(key, last_ts)</text><polygon fill="#A80036" points="189.5,176.9609,179.5,180.9609,189.5,184.9609,185.5,180.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="183.5" x2="370.5" y1="180.9609" y2="180.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="195.5" y="175.895">value</text><polygon fill="#A80036" points="71.5,206.0938,61.5,210.0938,71.5,214.0938,67.5,210.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="65.5" x2="177.5" y1="210.0938" y2="210.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="77.5" y="205.0278">value</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="408.5" y1="219.0938" y2="219.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="18" y="229.3042">[do set, del]</text><path d="M23,239.8984 L93,239.8984 L93,246.8984 L83,256.8984 L23,256.8984 L23,239.8984 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="175" x="23" y="239.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="252.9653">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="108" y="252.1089">[if op == del]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="102.5" y1="278.1641" y2="278.1641"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="102.5" x2="102.5" y1="278.1641" y2="291.1641"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61.5" x2="102.5" y1="291.1641" y2="291.1641"/><polygon fill="#A80036" points="71.5,287.1641,61.5,291.1641,71.5,295.1641,67.5,291.1641" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="67.5" y="273.0981">value = nil</text><polygon fill="#A80036" points="166.5,323.2969,176.5,327.2969,166.5,331.2969,170.5,327.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="172.5" y1="327.2969" y2="327.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="67.5" y="322.231">set(key, value)</text><polygon fill="#A80036" points="304.5,352.4297,314.5,356.4297,304.5,360.4297,308.5,356.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178.5" x2="310.5" y1="356.4297" y2="356.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="185.5" y="351.3638">ts = getTso()</text><polygon fill="#A80036" points="359.5,381.5625,369.5,385.5625,359.5,389.5625,363.5,385.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="178.5" x2="365.5" y1="385.5625" y2="385.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="185.5" y="380.4966">set(key, value, ts)</text><polygon fill="#A80036" points="189.5,410.6953,179.5,414.6953,189.5,418.6953,185.5,414.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="183.5" x2="370.5" y1="414.6953" y2="414.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="195.5" y="409.6294">error</text><polygon fill="#A80036" points="71.5,439.8281,61.5,443.8281,71.5,447.8281,67.5,443.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="65.5" x2="177.5" y1="443.8281" y2="443.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="77.5" y="438.7622">error</text><!--
@startuml
alt do get
    client -> mtikv_cli: get(key)
    mtikv_cli -> pd: last_ts = getTso()
    mtikv_cli -> mtikv: get(key, last_ts)
    mtikv- ->mtikv_cli: value
    mtikv_cli->client: value
else do set, del
    opt if op == del
        client -> client: value = nil
    end
    client -> mtikv_cli: set(key, value)
    mtikv_cli -> pd: ts = getTso()
    mtikv_cli -> mtikv: set(key, value, ts)
    mtikv- ->mtikv_cli: error
    mtikv_cli->client: error
end
@enduml

PlantUML version 1.2019.04(Fri Mar 29 15:44:36 UTC 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_201-heroku-b09
Operating System: Linux
OS Version: 4.4.0-1048-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>